---
// VideoSection component for embedding Vimeo video with lazy loading facade
// Uses a click-to-load pattern to avoid loading heavy Vimeo resources until needed
---

<div class="mt-16 md:mt-24">
  <h2 class="text-4xl lg:text-5xl font-bold lg:tracking-tight bg-gradient-to-r from-purple-500 to-cyan-500 bg-clip-text text-transparent text-center">
    Watch Now
  </h2>
  <p class="text-lg mt-4 text-slate-600 text-center max-w-2xl mx-auto">
    Check out our latest video and get a glimpse into the world of DJStrappy.
  </p>
  <div class="mt-8 flex justify-center">
    <div class="w-full max-w-4xl aspect-video rounded-lg overflow-hidden shadow-xl">
      <div 
        id="video-facade" 
        class="video-facade w-full h-full bg-gradient-to-br from-purple-900 to-cyan-900 flex items-center justify-center cursor-pointer relative"
        role="button"
        tabindex="0"
        aria-label="Play DJStrappy Video">
        <div class="play-button">
          <svg class="w-20 h-20 text-white opacity-90 hover:opacity-100 transition-opacity" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </div>
        <span class="absolute bottom-4 text-white/70 text-sm">Click to load video</span>
      </div>
      <iframe
        id="vimeo-iframe"
        data-src="https://player.vimeo.com/video/1142285516?h=&title=0&byline=0&portrait=0&autoplay=1"
        class="w-full h-full border-0 hidden"
        allow="autoplay; fullscreen; picture-in-picture"
        allowfullscreen
        title="DJStrappy Video">
      </iframe>
    </div>
  </div>
</div>

<style>
  .video-facade {
    background-image: linear-gradient(135deg, rgba(139, 92, 246, 0.8) 0%, rgba(6, 182, 212, 0.8) 100%);
  }
  
  .play-button {
    width: 80px;
    height: 80px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease, background 0.2s ease;
  }
  
  .video-facade:hover .play-button,
  .video-facade:focus .play-button {
    transform: scale(1.1);
    background: rgba(255, 255, 255, 0.3);
  }
  
  .video-facade:focus {
    outline: 2px solid #06B6D4;
    outline-offset: 2px;
  }
</style>

<script>
  function initVideoFacade(): void {
    const facade = document.getElementById('video-facade');
    const iframe = document.getElementById('vimeo-iframe') as HTMLIFrameElement | null;
    
    if (!facade || !iframe) return;
    
    function loadVideo(): void {
      if (!iframe) return;
      const src = iframe.getAttribute('data-src');
      if (src) {
        iframe.src = src;
        iframe.classList.remove('hidden');
        facade?.classList.add('hidden');
      }
    }
    
    facade.addEventListener('click', loadVideo);
    facade.addEventListener('keydown', (e: KeyboardEvent) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        loadVideo();
      }
    });
  }
  
  // Initialize on page load
  initVideoFacade();
  
  // Re-initialize on Astro page transitions
  document.addEventListener('astro:page-load', initVideoFacade);
</script>
